# pdfsharp-test
Skeletal app to illustrate an issue with a System.OutOfMemoryException being thrown by pdfsharp 1.50 beta, when processing certain PDF files.

````
2015-06-15 11:52:20,511 [  8] ERROR (null) - System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)
   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)
   at System.Text.StringBuilder.Append(Char value)
   at PdfSharp.Pdf.IO.Lexer.AppendAndScanNextChar()
   at PdfSharp.Pdf.IO.Lexer.ScanName()
   at PdfSharp.Pdf.IO.Lexer.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ReadObject(PdfObject pdfObject, PdfObjectID objectID, Boolean includeReferences, Boolean fromObjecStream)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(Int32 objectNumber, Int32 offset)
   at PdfSharp.Pdf.Advanced.PdfObjectStream.ReadCompressedObject(Int32 index)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(PdfObjectID objectID, Int32 index)
   at PdfSharp.Pdf.IO.PdfReader.Open(Stream stream, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider passwordProvider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider provider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, PdfDocumentOpenMode openmode)
   at PDFTest.Program.JoinPDFDocuments(List`1 PDFFilePaths) in c:\Users\Administrator\Documents\Leigh\pdfsharp-test\PDFTest\Program.cs:line 44

````

Full example output:

````
2015-06-15 11:51:46,864 [  8] DEBUG (null) - JoinPDFDocument()...
2015-06-15 11:51:46,937 [  8] DEBUG (null) - PDF document 1/2 ../../PDF files/example_001.pdf...
2015-06-15 11:51:47,017 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:51:47,036 [  8] DEBUG (null) - PDF document 2/2 ../../PDF files/example_001.pdf...
2015-06-15 11:51:47,052 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:51:47,054 [  8] DEBUG (null) - Saving to C:\Users\Administrator\AppData\Local\Temp\2\tmpD39A.tmp...
2015-06-15 11:51:47,086 [  8] DEBUG (null) - JoinPDFDocument()...
2015-06-15 11:51:47,088 [  8] DEBUG (null) - PDF document 1/2 ../../PDF files/example_001.pdf...
2015-06-15 11:51:47,103 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:51:47,104 [  8] DEBUG (null) - PDF document 2/2 ../../PDF files/example_009.pdf...
2015-06-15 11:51:47,123 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:51:47,124 [  8] DEBUG (null) - Saving to C:\Users\Administrator\AppData\Local\Temp\2\tmpD3E9.tmp...
2015-06-15 11:51:47,128 [  8] DEBUG (null) - JoinPDFDocument()...
2015-06-15 11:51:47,130 [  8] DEBUG (null) - PDF document 1/2 ../../PDF files/example_001.pdf...
2015-06-15 11:51:47,145 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:51:47,146 [  8] DEBUG (null) - PDF document 2/2 ../../PDF files/example_010.pdf...
2015-06-15 11:51:47,186 [  8] DEBUG (null) - Page 0/4...
2015-06-15 11:51:47,187 [  8] DEBUG (null) - Page 1/4...
2015-06-15 11:51:47,189 [  8] DEBUG (null) - Page 2/4...
2015-06-15 11:51:47,190 [  8] DEBUG (null) - Page 3/4...
2015-06-15 11:51:47,192 [  8] DEBUG (null) - Saving to C:\Users\Administrator\AppData\Local\Temp\2\tmpD428.tmp...
2015-06-15 11:51:47,208 [  8] DEBUG (null) - JoinPDFDocument()...
2015-06-15 11:51:47,210 [  8] DEBUG (null) - PDF document 1/2 ../../PDF files/Troublesome.pdf...
2015-06-15 11:52:20,511 [  8] ERROR (null) - System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)
   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)
   at System.Text.StringBuilder.Append(Char value)
   at PdfSharp.Pdf.IO.Lexer.AppendAndScanNextChar()
   at PdfSharp.Pdf.IO.Lexer.ScanName()
   at PdfSharp.Pdf.IO.Lexer.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ReadObject(PdfObject pdfObject, PdfObjectID objectID, Boolean includeReferences, Boolean fromObjecStream)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(Int32 objectNumber, Int32 offset)
   at PdfSharp.Pdf.Advanced.PdfObjectStream.ReadCompressedObject(Int32 index)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(PdfObjectID objectID, Int32 index)
   at PdfSharp.Pdf.IO.PdfReader.Open(Stream stream, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider passwordProvider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider provider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, PdfDocumentOpenMode openmode)
   at PDFTest.Program.JoinPDFDocuments(List`1 PDFFilePaths) in c:\Users\Administrator\Documents\Leigh\pdfsharp-test\PDFTest\Program.cs:line 44
2015-06-15 11:52:20,697 [  8] DEBUG (null) - JoinPDFDocument()...
2015-06-15 11:52:20,715 [  8] DEBUG (null) - PDF document 1/2 ../../PDF files/example_001.pdf...
2015-06-15 11:52:20,732 [  8] DEBUG (null) - Page 0/1...
2015-06-15 11:52:20,733 [  8] DEBUG (null) - PDF document 2/2 ../../PDF files/Troublesome.pdf...
2015-06-15 11:52:55,990 [  8] ERROR (null) - System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
   at System.Text.StringBuilder.ExpandByABlock(Int32 minBlockCharCount)
   at System.Text.StringBuilder.Append(Char value, Int32 repeatCount)
   at System.Text.StringBuilder.Append(Char value)
   at PdfSharp.Pdf.IO.Lexer.AppendAndScanNextChar()
   at PdfSharp.Pdf.IO.Lexer.ScanName()
   at PdfSharp.Pdf.IO.Lexer.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ScanNextToken()
   at PdfSharp.Pdf.IO.Parser.ReadObject(PdfObject pdfObject, PdfObjectID objectID, Boolean includeReferences, Boolean fromObjecStream)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(Int32 objectNumber, Int32 offset)
   at PdfSharp.Pdf.Advanced.PdfObjectStream.ReadCompressedObject(Int32 index)
   at PdfSharp.Pdf.IO.Parser.ReadCompressedObject(PdfObjectID objectID, Int32 index)
   at PdfSharp.Pdf.IO.PdfReader.Open(Stream stream, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider passwordProvider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, String password, PdfDocumentOpenMode openmode, PdfPasswordProvider provider)
   at PdfSharp.Pdf.IO.PdfReader.Open(String path, PdfDocumentOpenMode openmode)
   at PDFTest.Program.JoinPDFDocuments(List`1 PDFFilePaths) in c:\Users\Administrator\Documents\Leigh\pdfsharp-test\PDFTest\Program.cs:line 44
````